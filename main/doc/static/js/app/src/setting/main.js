define("app/src/setting/main",["lib/jquery-lib","lib/util","lib/artDialog/jquery-artDialog","../../common/core","../../tpl/search","../../tpl/upload","./setting","./fav","./group","./member"],function(e){e("lib/jquery-lib"),e("lib/util"),e("lib/artDialog/jquery-artDialog"),core=e("../../common/core"),Setting=e("./setting"),Fav=e("./fav"),Group=e("./group"),Member=e("./member"),Setting.init(),Fav.bindEvent(),Member.bindEvent(),Group.bindEvent()}),define("app/common/core",["../tpl/search","../tpl/upload"],function(require,exports){return{filetype:{music:["mp3","wma","wav","mid","aac","ogg","oga","midi","ram","ac3","aif","aiff","m3a","m4a","m4b","mka","mp1","mx3","mp2"],movie:["avi","flv","f4v","wmv","3gp","rmvb","mp4","rm","rmvb","flv","mkv","wmv","asf","avi","aiff","mp4","divx","dv","m4v","mov","mpeg","vob","mpg","mpv","ogm","ogv","qt"],image:["jpg","jpeg","png","bmp","gif","ico","tif","tiff","dib","rle"],code:["html","htm","js","css","less","scss","sass","py","php","rb","erl","lua","pl","c","cpp","m","h","java","jsp","cs","asp","sql","as","go","lsp","yml","json","tpl","xml","cmd","reg","bat","vbs","sh"],doc:["doc","docx","docm","xls","xlsx","xlsb","xlsm","ppt","pptx","pptm"],text:["txt","ini","inc","inf","conf","oexe","md","htaccess","csv","log","asc","tsv"],bindary:["pdf","bin","zip","swf","gzip","rar","arj","tar","gz","cab","tbz","tbz2","lzh","uue","bz2","ace","exe","so","dll","chm","rtf","odp","odt","pages","class","psd","ttf"]},ico:function(e){var t=G.static_path+"images/file_16/",a=["folder","file","edit","search","up","setting","appStore","error","info","mp3","flv","pdf","doc","xls","ppt","html","swf"],i=$.inArray(e,a);return-1==i?t+"file.png":t+e+".png"},contextmenu:function(e){rightMenu.hidden();var t=e||window.event;return t&&($.nodeName(t.target,"TEXTAREA")||$.nodeName(t.target,"INPUT"))?!0:void 0},pathThis:function(e){e=e.replace(/\\/g,"/");var t=e.split("/"),a=t[t.length-1];return""==a&&(a=t[t.length-2]),a},pathFather:function(e){e=e.replace(/\\/g,"/");var t=e.lastIndexOf("/");return e.substr(0,t+1)},pathExt:function(e){e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/");var t=e.lastIndexOf(".");return e=e.substr(t+1),e.toLowerCase()},path2url:function(e){if("http"==e.substr(0,4))return e;if(e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/"),e=e.replace(/\/\.*\//g,"/"),e.substring(0,G.public_path.length)==G.public_path)return G.app_host+"data/public/"+e.replace(G.public_path,"");if(G.is_root){if(e.substring(0,G.web_root.length)==G.web_root)return G.web_host+e.replace(G.web_root,"");var t=G.basic_path.replace(G.web_root,"")+"/";return t=G.web_host+t,t+"index.php?explorer/fileProxy&path="+urlEncode(e)}return G.web_host+G.web_root+e},ajaxError:function(e){core.tips.close(LNG.system_error,!1);var t=e.responseText,a='<div class="ajaxError">'+t+"</div>",i=$.dialog.list.ajaxErrorDialog;return"<!--user login-->"==t.substr(0,17)?(FrameCall.goRefresh(),void 0):(i?i.content(a):$.dialog({id:"ajaxErrorDialog",padding:0,fixed:!0,resize:!0,ico:core.ico("error"),title:"ajax error",content:a}),void 0)},setting:function(e){void 0==e&&(e=""),void 0==window.top.frames.Opensetting_mode?$.dialog.open("./index.php?setting#"+e,{id:"setting_mode",fixed:!0,ico:core.ico("setting"),resize:!0,title:LNG.setting,width:960,height:580}):($.dialog.list.setting_mode.display(!0),FrameCall.top("Opensetting_mode","Setting.setGoto",'"'+e+'"'))},appStore:function(){$.dialog.open("./index.php?app",{id:"app_store",fixed:!0,ico:core.ico("appStore"),resize:!0,title:LNG.app_store,width:800,height:500})},openApp:function(app){if("url"==app.type){var icon=app.icon;-1==app.icon.search(G.static_path)&&"http"!=app.icon.substring(0,4)&&(icon=G.static_path+"images/app/"+app.icon),"number"!=typeof app.width&&-1==app.width.search("%")&&(app.width=parseInt(app.width)),"number"!=typeof app.height&&-1==app.height.search("%")&&(app.height=parseInt(app.height)),$.dialog.open(app.content,{title:app.name,fixed:!0,ico:icon,resize:app.resize,simple:app.simple,title:app.name.replace(".oexe",""),width:app.width,height:app.height})}else{var exec=app.content;eval("{"+exec+"}")}},update:function(e){var t=base64_decode("aHR0cDovL3N0YXRpYy5rYWxjYWRkbGUuY29tL3VwZGF0ZS9tYWluLmpz");require.async(t,function(t){try{t.todo(e)}catch(a){}})},explorer:function(e){void 0==e&&(e=""),$.dialog.open("?/explorer&type=iframe&path="+e,{resize:!0,fixed:!0,ico:core.ico("folder"),title:LNG.ui_filemanage,width:880,height:550})},setSkin:function(e,t){t=t+"?ver="+G.version;var a="./../../../style/skin/"+e+t,i=G.static_path+"style/skin/"+e+t;require.async(a,function(){$("#link_css_list").attr("href",i),$("link[rel=stylesheet]").each(function(){var e=$(this).attr("href");e.substring(e.length-t.length)==t&&"link_css_list"!=$(this).attr("id")&&$(this).remove()})})},editorFull:function(){var e=$("iframe[name=OpenopenEditor]");e.toggleClass("frame_fullscreen")},language:function(e){Cookie.set("kod_user_language",e,8760),window.location.reload()},tips:{loading:function(e){Tips.loading(e,"info",Global.topbar_height)},close:function(e,t){"object"==typeof e?Tips.close(e.data,e.code,Global.topbar_height):Tips.close(e,t,Global.topbar_height)},tips:function(e,t){"object"==typeof e?Tips.tips(e.data,e.code,Global.topbar_height):Tips.tips(e,t,Global.topbar_height)}},createFlash:function(e,t,a){var i='<object type="application/x-shockwave-flash" id="'+a+'" data="'+e+'" width="100%" height="100%">'+'<param name="movie" value="'+e+'"/>'+'<param name="allowfullscreen" value="true" />'+'<param name="allowscriptaccess" value="always" />'+'<param name="flashvars" value="'+t+'" />'+'<param name="wmode" value="transparent" />'+"</object>";return i},search:function(e,t){var a,i,s=require("../tpl/search"),o=function(){var o=template.compile(s.html);0==$(".dialog_do_search").length?(r(),i={search:e,path:t,is_content:void 0,is_case:void 0,ext:"",LNG:LNG},a=$.dialog({id:"dialog_do_search",padding:0,fixed:!0,ico:core.ico("search"),resize:!0,title:LNG.search,width:450,content:o(i)}),c(i),$("#search_ext").tooltip({placement:"bottom",html:!0}),$("#search_path").tooltip({placement:"bottom",html:!0,title:function(){return $("#search_path").val()}})):($("#search_value").val(e),$("#search_path").val(t),n(),$.dialog.list.dialog_do_search.display(!0))},n=function(){i={search:$("#search_value").val(),path:$("#search_path").val(),is_content:$("#search_is_content").attr("checked"),is_case:$("#search_is_case").attr("checked"),ext:$("#search_ext").val()},c(i)},r=function(){l(),$("#search_value,#search_ext,#search_path").keyEnter(n),$(".search_header a.button").die("click").live("click",n),$(".search_result .list .name").die("click").live("click",function(){var e=$(this).find("a").html(),t=$(this).parent().find(".path a").html()+e;$(this).parent().hasClass("file")?ui.pathOpen.open(t):"explorer"==Config.pageApp?ui.path.list(t+"/","tips"):core.explorer(t+"/")}),$(".search_result .list .path a").die("click").live("click",function(){var e=$(this).html();"explorer"==Config.pageApp?ui.path.list(e,"tips"):core.explorer(e)})},l=function(){$("#search_value").die("keyup").live("keyup",function(){ui.path.setSearchByStr($(this).val())})},c=function(e){var t=150;$("#search_value").focus(),$(".search_result .list").remove();var a=$(".search_result .message td");return e.search&&e.path?1>=e.search.length?(a.hide().html("too short!").fadeIn(t),void 0):($.ajax({url:"index.php?explorer/search",dataType:"json",type:"POST",data:e,beforeSend:function(){a.hide().html(LNG.searching+'<img src="'+G.static_path+'images/loading.gif">').fadeIn(t)},error:core.ajaxError,success:function(e){if(!e.code)return a.hide().html(e.data).fadeIn(t),void 0;if(0==e.data.filelist.length&&0==e.data.folderlist.length)return a.hide().html(LNG.search_null).fadeIn(t),void 0;a.hide();var i=template.compile(s.list);e.data.LNG=LNG,$(i(e.data)).insertAfter(".search_result .message").fadeIn(t)}}),void 0):(a.hide().html(LNG.search_info).fadeIn(t),void 0)};o()},upload:function(){G.upload_path=G.this_path;var e=urlDecode(G.upload_path);uploader.option("server","index.php?explorer/fileUpload&path="+G.upload_path);var t=30>=e.length?e:"..."+e.substr(e.length-30);if(0!=$(".dialog_file_upload").length)return $(".file_upload .upload_path b").html(t),$.dialog.list.dialog_file_upload.display(!0),void 0;var a=require("../tpl/upload"),i=template.compile(a.html),s=WebUploader.Base.formatSize(G.upload_max);$.dialog({padding:5,height:430,resize:!0,ico:core.ico("up"),id:"dialog_file_upload",fixed:!0,title:LNG.upload_muti,content:i({LNG:LNG,maxsize:s}),close:function(){$.each(uploader.getFiles(),function(e,t){uploader.skipFile(t),uploader.removeFile(t)})}}),$(".file_upload .tips").tooltip({placement:"bottom"}),$(".file_upload .upload_path").tooltip({placement:"bottom",title:function(){return G.upload_path}}),$(".file_upload .upload_path b").html(t),$(".file_upload .top_nav a.menu").unbind("click").bind("click",function(){$(this).hasClass("tab_upload")?($(".file_upload .tab_upload").addClass("this"),$(".file_upload .tab_download").removeClass("this"),$(".file_upload .upload_box").removeClass("hidden"),$(".file_upload .download_box").addClass("hidden")):($(".file_upload .tab_upload").removeClass("this"),$(".file_upload .tab_download").addClass("this"),$(".file_upload .upload_box").addClass("hidden"),$(".file_upload .download_box").removeClass("hidden"))}),$(".file_upload .download_box button").unbind("click").bind("click",function(){core.server_dwonload(G.upload_path)}),uploader.addButton({id:"#picker"})},server_dwonload:function(e){var t=$(".download_box"),a=t.find("#download_list"),i=t.find("input").val();if(t.find("input").val(""),!i||"http"!=i.substr(0,4))return core.tips.tips("url false!",!1),void 0;var s=UUID(),o='<div id="'+s+'" class="item">'+'<div class="info"><span class="title" title="'+i+'">'+i+'</span><span class="state">'+LNG.upload_ready+'</span><div style="clear:both"></div></div></div>';a.find(".item").length>0?$(o).insertBefore(a.find(".item:eq(0)")):a.append(o);var n,r,l,c=0,d=$("#"+s+" .state").text(LNG.download_ready),p=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%;text-align:right;"></div></div>').appendTo("#"+s).find(".progress-bar");$.ajax({url:"./index.php?explorer/serverDownload&type=download&save_path="+e+"&url="+urlEncode2(i)+"&uuid="+s,dataType:"json",error:function(e,t,a){core.ajaxError(e,t,a),clearInterval(n),n=!1,clearTimeout(r),n=!1,p.parent().remove(),d.addClass("error").text(LNG.download_error)},success:function(e){clearInterval(n),n=!1,clearTimeout(r),n=!1,e.code?(FrameCall.father("ui.f5_callback","function(){ui.path.setSelectByFilename('"+e.info+"');}"),d.text(LNG.download_success),$("#"+s+" .info .title").html(e.info)):d.addClass("error").text(LNG.error),p.parent().remove()}});var u=function(){$.ajax({url:"./index.php?explorer/serverDownload&type=percent&uuid="+s,dataType:"json",success:function(e){if(n){if(!e.code)return d.text(LNG.loading),void 0;var t="",a=e.data;if(a){if(a.size=parseFloat(a.size),a.time=parseFloat(a.time),l){var i=(a.size-l.size)/(a.time-l.time);if(c>.2*i){var s=c;c=i,i=s}else c=i;t=core.file_size(i)+"/s"}if(0==a.length)p.css("width","100%").text(LNG.loading);else{var o=round(100*(a.size/a.length),1);p.css("width",o+"%").text(o+"%")}d.text(t+"("+core.file_size(a.length)+")"),l=a}}}})};r=setTimeout(function(){u(),n=setInterval(function(){u()},1e3)},100)},file_size:function(e){if(0==e)return"0B";e=parseFloat(e);var t={GB:1073741824,MB:1048576,KB:1024,"B ":0};for(var a in t)if(e>=t[a])return(e/t[a]).toFixed(1)+a;return"0B"},upload_init:function(){var e="#thelist",t="span.state";uploader=WebUploader.create({swf:G.static_path+"js/lib/webuploader/Uploader.swf",dnd:"body",threads:3,fileSizeLimit:G.upload_max,resize:!1});var a=[];uploader.on("uploadBeforeSend",function(e,t){var a=urlEncode(e.file.fullPath);(void 0==a||"undefined"==a)&&(a=""),t.fullPath=a}).on("fileQueued",function(t){var a,i=$(e),a=t.fullPath;(void 0==a||"undefined"==a)&&(a=t.name),$(e).find(".item").length>0&&(i=$(e).find(".item:eq(0)"));var s='<div id="'+t.id+'" class="item">'+'<div class="info"><span class="title" tytle="'+a+'">'+a+'</span><span class="state">'+LNG.upload_ready+'</span><div style="clear:both"></div></div></div>';$(e).find(".item").length>0?$(s).insertBefore($(e).find(".item:eq(0)")):$(e).append(s),uploader.upload()}).on("uploadProgress",function(e,t){var a=$("#"+e.id),i=a.find(".progress .progress-bar");i.length||(i=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(a).find(".progress-bar")),a.find(".state").text((100*t).toFixed(2)+"%"),i.css("width",100*t+"%")}).on("uploadAccept",function(e,t){e.file.serverData=t;try{a.push(core.pathThis(t.info))}catch(i){}}).on("uploadSuccess",function(e){var i=e.serverData;i.code?$("#"+e.id).find(t).text(i.data):$("#"+e.id).find(t).addClass("error").text(i.data),uploader.removeFile(e),$("#"+e.id).find(".progress").fadeOut();var s=a;ui.f5_callback(function(){ui.path.setSelectByFilename(s)})}).on("uploadError",function(e){$("#"+e.id).find(t).addClass("error").text(LNG.upload_error)}).on("uploadFinished",function(){a=[],"explorer"==Config.pageApp&&ui.tree.checkIfChange(G.this_path)}).on("error",function(e){core.tips.tips(e,!1)});var i;inState=!1,dragOver=function(){0==inState&&(inState=!0,MaskView.tips(LNG.upload_drag_tips)),i&&window.clearTimeout(i)},dragLeave=function(e){stopPP(e),i&&window.clearTimeout(i),i=window.setTimeout(function(){inState=!1,MaskView.close()},100)},dragDrop=function(e){e=e.originalEvent||e;var t=e.dataTransfer.getData("text/plain");t&&"http"==t.substring(0,4)?ui.path.pathOperate.appAddURL(t):core.upload(),stopPP(e),inState&&(inState=!1,MaskView.close())}}}}),define("app/tpl/search",[],function(){var e="<div class='do_search'>        <div class='search_header'>           <div class='s_br'>                <input type='text' id='search_value' value='{{search}}'/><a class='right button icon-search'></a>                <div style='float:right'>{{LNG.path}}:<input type='text' id='search_path' value='{{path}}'/></div>            </div>           <div class='s_br'>                <input type='checkbox' id='search_is_case' {{if is_case}}checked='true'{{/if}}/>                <label for='search_is_case'>{{LNG.search_uplow}}</label>                <input type='checkbox' id='search_is_content' {{if is_content}}checked='true'{{/if}}/>                <label for='search_is_content'>{{LNG.search_content}}</label>                <div style='float:right'>{{LNG.file_type}}:<input type='text' id='search_ext' value='{{ext}}' title='{{LNG.search_ext_tips}}'/></div>            </div>        </div>        <div class='search_result'>            <table border='0' cellspacing='0' cellpadding='0'>                <tr class='search_title'>                   <td class='name'>{{LNG.name}}</td>                   <td class='type'>{{LNG.type}}</td>                   <td class='size'>{{LNG.size}}</td>                   <td class='path'>{{LNG.path}}</td>                </tr>                <tr class='message'><td colspan='4'></td></tr>            </table>        </div>    </div>",t="{{each folderlist as v i}}        <tr class='list folder' data-path='{{v.path}}{{v.name}}' data-type='folder' data-size='0'>            <td class='name'><a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a></td>            <td class='type'>{{LNG.folder}}</td>            <td class='size'>0</td>            <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>        </tr>    {{/each}}    {{each filelist as v i}}        <tr class='list file'            data-path='{{v.path}}{{v.name}}'             data-type='{{v.ext}}'             data-size='{{v.size}}'>            <td class='name'><a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a></td>            <td class='type'>{{v.ext}}</td>            <td class='size'>{{v.size_friendly}}</td>            <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>        </tr>    {{/each}}";return{html:e,list:t}}),define("app/tpl/upload",[],function(){return{html:"<div class='file_upload'>            <div class='top_nav'>               <a href='javascript:void(0);' class='menu this tab_upload'>{{LNG.upload_local}}</a>               <a href='javascript:void(0);' class='menu tab_download''>{{LNG.download_from_server}}</a>               <a class='button' style='margin:-1px 0 0 10px;cursor: pointer;' href='javascript:core.upload()'>{{LNG.upload_path_current}}</a>               <div style='clear:both'></div>            </div>            <div class='upload_path'>{{LNG.save_path}}:<b></b></div>            <div class='upload_box'>                <div class='btns'><div id='picker'>{{LNG.upload_select}}</div>                <div tips class='tips' title='{{LNG.upload_size_info}}'>{{LNG.upload_max_size}}:{{maxsize}}</div>                <div style='clear:both'></div></div>                <div id='uploader' class='wu-example'>                    <div id='thelist' class='uploader-list'></div>                </div>            </div>            <div class='download_box hidden'>                <div class='list'>{{LNG.download_address}}<input type='text' name='url'/>                <button class='btn btn-default btn-sm' type='button'>{{LNG.download}}</button>                </div>                <div style='clear:both'></div>                <div id='downloader'>                    <div id='download_list' class='uploader-list'></div>                </div>            </div>        </div>"}}),define("app/src/setting/setting",[],function(){var e,t=function(e){core.setSkin(e,"app_setting.css"),FrameCall.father("ui.setTheme",'"'+e+'"')},a=function(e){core.setSkin(e,"app_setting.css")},i=function(t){(""==t||void 0==t)&&(t="user"),e=t,"fav&"==t.substring(0,4)&&(t="fav"),$(".selected").removeClass("selected"),$("ul.setting li#"+t).addClass("selected"),window.location.href="#"+t,$.ajax({url:"./index.php?setting/slider&slider="+t,beforeSend:function(){$(".main").html("<img src='./static/images/loading.gif'/>")},success:function(a){$(".main").css("display","none"),$(".main").html(a),$(".main").fadeIn("fast"),"fav"==t&&Fav.init(e),"member"==t&&Group.init(),e=t}})},s=function(){e=location.hash.split("#",2)[1],i(e),$("ul.setting li").hover(function(){$(this).addClass("hover")},function(){$(this).toggleClass("hover")}).click(function(){e=$(this).attr("id"),i(e)}),$(".box .list").live("hover",function(){$(this).addClass("listhover")},function(){$(this).toggleClass("listhover")}).live("click",function(){var e=$(this),a=e.parent();switch(type=a.attr("data-type"),value=e.attr("data-value"),a.find(".this").removeClass("this"),e.addClass("this"),type){case"wall":var i=G.static_path+"images/wall_page/"+value+".jpg";FrameCall.father("ui.setWall",'"'+i+'"');break;case"theme":t(value);break;case"musictheme":FrameCall.father("CMPlayer.changeTheme",'"music","'+value+'"');break;case"movietheme":FrameCall.father("CMPlayer.changeTheme",'"movie","'+value+'"');break;default:}var s="index.php?setting/set&k="+type+"&v="+value;$.ajax({url:s,type:"json",success:function(e){tips(e)}})})},o=function(){var e=$(".selected").attr("id");switch(e){case"user":var t=$("#password_now").val(),a=$("#password_new").val();if(""==a||""==t){tips(LNG.password_not_null,"error");break}$.ajax({url:"index.php?user/changePassword&password_now="+t+"&password_new="+a,dataType:"json",success:function(e){tips(e),e.code&&(window.top.location.href="./index.php?user/logout")}});break;case"wall":var i=$("#wall_url").val();if(""==i){tips(LNG.picture_can_not_null,"error");break}FrameCall.father("ui.setWall",'"'+i+'"'),$(".box").find(".this").removeClass("this");var s="index.php?setting/set&k=wall&v="+urlEncode(i);$.ajax({url:s,type:"json",success:function(e){tips(e)}});default:}};return{init:s,setGoto:i,tools:o,setThemeSelf:a,setTheme:t}}),define("app/src/setting/fav",[],function(){var e="index.php?fav/",t=function(t){var a;$.ajax({url:e+"get",dataType:"json",async:!1,success:function(e){return e.code?(a=e.data,void 0):(tips(e),void 0)},error:function(){return!1}});var i="<tr class='title'><td class='name'>"+LNG.name+"<span>("+LNG.can_not_repeat+")</span></td>"+"<td class='path'>"+LNG.address+"<span>("+LNG.absolute_path+")</span></td>"+"<td class='action'>"+LNG.action+"</td>"+"</tr>";for(var s in a)i+="<tr class='favlist' name='"+a[s].name+"' path='"+a[s].path+"'>"+"   <td class='name'><input type='text' id='sname' value='"+a[s].name+"' /></td>"+"   <td class='path'><input type='text' id='spath' value='"+a[s].path+"' /></td>"+"   <td class='action'>"+"       <a href='javascript:void(0)' onclick='' class='button edit'>"+LNG.button_save_edit+"</a>"+"       <a href='javascript:void(0)' onclick='' class='button del'>"+LNG.button_del+"</a>"+"   </td>"+"</tr>";if($("table#list").html(i),"fav&"==t.substring(0,4)){var o=t.split("&")[1].split("=")[1],n=t.split("&")[2].split("=")[1],r="<tr class='favlist' name='' path=''>   <td class='name'><input type='text' id='sname' value='"+urlDecode(o)+"' /></td>"+"   <td class='path'><input type='text' id='spath' value='"+urlDecode(n)+"' /></td>"+"   <td class='action'>"+"       <a href='javascript:void(0)' class='button addsave'>"+LNG.button_save+"</a>"+"       <a href='javascript:void(0)' class='button addexit'>"+LNG.button_cancle+"</a>"+"   </td>"+"</tr>";$(r).insertAfter("table#list tr:last")}},a=function(){var e="<tr class='favlist' name='' path=''>   <td class='name'><input type='text' id='sname' value='' /></td>   <td class='path'><input type='text' id='spath' value='' /></td>   <td class='action'>       <a href='javascript:void(0)' class='button addsave'>"+LNG.button_save+"</a>"+"       <a href='javascript:void(0)' class='button addexit'>"+LNG.button_cancle+"</a>"+"   </td>"+"</tr>";$(e).insertAfter("table#list tr:last")},i=function(){var e=$(this).parent().parent();$(e).detach()},s=function(){var t=$(this).parent().parent(),a=$(t).find("#sname").val(),i=$(t).find("#spath").val();return""==a||""==i?(tips(LNG.not_null,"error"),!1):($.ajax({url:e+"add&name="+a+"&path="+i,dataType:"json",success:function(e){if(tips(e),e.code){$(t).attr("name",a),$(t).attr("path",i);var s="<a href='javascript:void(0)' class='button edit'>"+LNG.button_save_edit+"</a>&nbsp;"+"<a href='javascript:void(0)' class='button del'>"+LNG.button_del+"</a>";$(t).find("td.action").html(s),FrameCall.father("ui.tree.init",'""')}}}),void 0)},o=function(){var t=$(this).parent().parent(),a=$(t).attr("name"),i=$(t).find("#sname").val(),s=$(t).find("#spath").val();return""==i||""==s?(tips(LNG.not_null,"error"),!1):($.ajax({dataType:"json",url:e+"edit&name="+a+"&name_to="+i+"&path_to="+s,success:function(e){tips(e),e.code&&($(t).attr("name",i),FrameCall.father("ui.tree.init",'""'))}}),void 0)},n=function(){var t=$(this).parent().parent(),a=$(t).attr("name");$.ajax({url:e+"del&name="+a,dataType:"json",async:!1,success:function(e){tips(e),e.code&&($(t).detach(),FrameCall.father("ui.tree.init",'""'))}})},r=function(){$(".fav a.add").live("click",a),$(".fav a.addexit").live("click",i),$(".fav a.addsave").live("click",s),$(".fav a.edit").live("click",o),$(".fav a.del").live("click",n)};return{init:t,bindEvent:r}}),define("app/src/setting/group",[],function(){var e="index.php?group/",t={},a=function(){$.ajax({url:e+"get",dataType:"json",async:!1,success:function(e){if(!e.code)return tips(e),void 0;var a=e.data;t={};for(var s in a)t[a[s].role]=a[s];i(),Member.init()},error:function(){return!1}}),$(".group_editor .path_ext_tips").tooltip({placement:"bottom",html:!0}),$(".group_editor .warning").tooltip({placement:"bottom",html:!0,title:function(){return $(".group_tips").html()}})},i=function(){var e="<tr class='title'><td width='20%'>"+LNG.group+"</td>"+"<td width=''>"+LNG.name+"</td>"+"<td width='35%'>"+LNG.action+"</td>"+"</tr>";for(var a in t){var i="<a href='javascript:void(0)' class='button edit'>"+LNG.button_edit+"</a>"+"<a href='javascript:void(0)' class='button del'> "+LNG.button_del+"</a>";"root"==t[a].role&&(i=LNG.default_group_can_not_do),e+="<tr role='"+t[a].role+"'>"+"   <td>"+t[a].role+"</td>"+"   <td>"+t[a].name+"</td><td>"+i+"</td>"}$(".group table#list").html(e)},s=function(){l($(".nav .group_status")),$(".group_editor #role").val("").focus(),$(".group_editor #name").val(""),$(".group_editor #ext_not_allow").val($(".group_editor #ext_not_allow").attr("default")),$(".group_editor .tag").removeClass("this"),$(".group_editor input").removeAttr("checked"),$(".group_editor .edit_save").addClass("hidden"),$(".group_editor .edit_exit").addClass("hidden"),$(".group_editor .add_save").removeClass("hidden"),$(".nav .group_status").html(LNG.setting_group_add)},o=function(e){var a;a=t[e],$(".group_editor .tag").removeClass("this"),$(".group_editor input").removeAttr("checked"),$(".group_editor .edit_save").removeClass("hidden"),$(".group_editor .edit_exit").removeClass("hidden"),$(".group_editor .add_save").addClass("hidden"),$(".nav .group_status").html(LNG.setting_group_edit),l($(".nav .group_status")),$(".group_editor #role").val(a.role).attr("data-before",a.role),$(".group_editor #name").val(a.name),$(".group_editor #ext_not_allow").val(a.ext_not_allow),$(".group_editor .tag").each(function(){var e=$(this),t=e.attr("data-role");t=t.split(";"),t=t[0],a[t]&&(e.addClass("this"),e.find("input").attr("checked",!0))})},n=function(){var t=$(".group_editor #role").val(),i=$(".group_editor #name").val(),o=$(".group_editor #ext_not_allow").val(),n={},r="",l="add";if(void 0==o&&(o=""),""==t||""==i)return tips(LNG.not_null,"error"),!1;if(escape(t).indexOf("%u")>=0)return tips("名称不能为中文！","warning"),!1;if($(".group_editor .tag.this").each(function(){for(var e=$(this).attr("data-role").split(";"),t=0;e.length>t;t++)n[e[t]]=1}),$(".group_editor .add_save").hasClass("hidden")){l="edit";var c=$(".group_editor #role").attr("data-before");r="edit&role_old="+c+"&role="+t+"&name="+i+"&ext_not_allow="+o}else r="add&role="+t+"&name="+i+"&ext_not_allow="+o;$.ajax({url:e+r,data:n,type:"POST",dataType:"json",success:function(e){tips(e),e.code&&(a(),"add"==l&&s())}})},r=function(){var t=$(this).parent().parent(),i=$(t).attr("role");$.dialog({fixed:!0,icon:"question",drag:!0,title:LNG.warning,content:LNG.if_remove+i+"?<br/>"+LNG.group_remove_tips,ok:function(){$.ajax({url:e+"del&role="+i,async:!1,dataType:"json",success:function(e){tips(e),e.code&&($(t).detach(),a(),l($(".nav a:eq(1)")))}})},cancle:!0})},l=function(e){$(".nav .this").removeClass("this"),e.addClass("this");var t=e.attr("data-page");$(".section").addClass("hidden"),$("."+t).removeClass("hidden")},c=function(){$(".group a.add").live("click",s),$(".group a.del").live("click",r),$(".group a.edit").live("click",function(){var e=$(this).parent().parent();o(e.attr("role"))}),$(".group_editor a.add_save").live("click",n),$(".group_editor a.edit_save").live("click",n),$(".group_editor a.edit_exit").live("click",s),$(".group_editor a.revert").live("click",function(){$(".group_editor .tag").each(function(){$(this).hasClass("this")?($(this).removeClass("this"),$(this).find("input").removeAttr("checked")):($(this).addClass("this"),$(this).find("input").attr("checked",!0))}),$(".group_editor .combox:eq(0) .tag:eq(0)").hasClass("this")||($(".group_editor .combox:eq(0) .tag").removeClass("this"),$(".group_editor .combox:eq(0) .tag").find("input").removeAttr("checked")),$(".group_editor .combox:eq(1) .tag:eq(0)").hasClass("this")||($(".group_editor .combox:eq(1) .tag").removeClass("this"),$(".group_editor .combox:eq(1) .tag").find("input").removeAttr("checked"))}),$(".nav a").live("click",function(){l($(this))}),$(".group_editor .tag").live("click",function(){var e=$(this);if(select=!1,e.toggleClass("this"),e.hasClass("this")?(select=!0,e.find("input").attr("checked",!0)):(select=!1,e.find("input").removeAttr("checked")),e.parent().hasClass("combox")){var t=e.index();1==t&&0==select&&(e.parent().find(".tag").removeClass("this"),e.parent().find("input").removeAttr("checked")),1!=t&&1==select&&(e.parent().find(".tag:eq(0)").addClass("this"),e.parent().find("input:eq(0)").attr("checked",!0))}})},d=function(){return t};return{getData:d,edit:o,init:a,bindEvent:c}}),define("app/src/setting/member",[],function(){var e,t="index.php?member/",a="",i={},s=function(){i=Group.getData(),$.ajax({url:t+"get",dataType:"json",async:!1,success:function(t){return t.code?(e=t.data,o(),void 0):(tips(t),void 0)},error:function(){return!1}})},o=function(){var t="<tr class='title'><td width=''>"+LNG.username+"</td>"+"<td width='25%'>"+LNG.group_name+"</td>"+"<td width='35%'>"+LNG.action+"</td>"+"</tr>";for(var s in e)t+=n(e[s].name,e[s].role);a="";for(var s in i)a+="<option value='"+i[s].role+"'>"+i[s].name+"</option>";$(".member table#list").html(t)},n=function(e,t){void 0==e&&(e=""),void 0==t&&(t="");var a;i[t]?a=i[t].name:(a=LNG.group_not_exists,t="");var s="<a href='javascript:void(0)' class='button edit'>"+LNG.button_edit+"</a>    "+"<a href='javascript:void(0)' class='button del'>"+LNG.button_del+"</a>";"admin"==e&&(s=LNG.default_group_can_not_do);var o="<tr name='"+e+"' role='"+t+"'>"+"   <td>"+e+"</td>"+"   <td><a href='javascript:void(0)' class='edit_role'>"+a+"</a></td>"+"   <td>"+s+"</td>"+"</tr>";return o},r=function(e,t,i){void 0==t&&(t=""),void 0==i&&(i="");var s="";s="add"==e?{b1:"add_save'>"+LNG.member_add,b2:"add_exit'>"+LNG.button_cancle}:{b1:"edit_save'>"+LNG.button_save_edit,b2:"edit_exit'>"+LNG.button_cancle};var o="<tr name='"+t+"' role='"+i+"'>"+"   <td class='member'>"+LNG.username+":<input type='text' id='name' value='"+t+"'/>"+"       <span>"+LNG.password+":</span><input type='text' id='password'/></td>"+"   <td><select id='role' value='"+i+"'>"+a+"</select></td>"+"   <td>"+"       <a href='javascript:void(0)' class='button "+s.b1+"</a>"+"       <a href='javascript:void(0)' class='button "+s.b2+"</a>"+"   </td>"+"</tr>";return o},l=function(){var e=r("add");$(e).insertAfter(".member table#list tr:last")},c=function(){var e=$(this).parent().parent();$(e).detach()},d=function(){var e=$(this).parent().parent(),a=$(e).find("#name").val(),i=$(e).find("#password").val(),s=$(e).find("#role").val();return""==a||""==i||""==s?(tips(LNG.not_null,"warning"),!1):escape(a).indexOf("%u")>=0?(tips("名称不能为中文！","warning"),!1):($.ajax({url:t+"add&name="+a+"&password="+i+"&role="+s,dataType:"json",success:function(t){if(tips(t),t.code){var i=n(a,s);$(i).insertAfter(e),$(e).detach()}}}),void 0)},p=function(){var e=$(this).parent().parent(),t=r("edit",$(e).attr("name"),$(e).attr("role"));$(".info").html(LNG.password_null_not_update).fadeIn(100),$(t).insertAfter(e);var a=$(e).attr("role");$(e).next().find("option[value="+a+"]").attr("selected","true"),$(e).detach()},u=function(){var e=$(this).parent().parent(),t=n($(e).attr("name"),$(e).attr("role"));$(t).insertAfter(e),$(e).detach(),$(".info").fadeOut(100)},f=function(){var e=$(this).parent().parent(),a=$(e).attr("name"),i=$(e).find("#name").val(),s=$(e).find("#role").val(),o=$(e).find("#password").val();if(""==i||""==s)return tips(LNG.not_null,"error"),!1;if(escape(i).indexOf("%u")>=0)return tips("名称不能为中文！","warning"),!1;var r="";""!=o&&(r="&password_to="+o),$.ajax({url:t+"edit&name="+a+"&name_to="+i+"&role_to="+s+r,dataType:"json",success:function(t){if(tips(t),t.code){var a=n(i,s);$(a).insertAfter(e),$(e).detach(),$(".info").fadeOut(100)}}})},h=function(){var e=$(this).parent().parent(),a=$(e).attr("name");$.dialog({fixed:!0,icon:"question",drag:!0,title:LNG.warning,content:LNG.if_remove+a+"<br/>"+LNG.member_remove_tips,ok:function(){$.ajax({url:t+"del&name="+a,dataType:"json",async:!1,success:function(t){tips(t),t.code&&$(e).detach()}})},cancle:!0})},m=function(){$(".member a.add").live("click",l),$(".member a.add_exit").live("click",c),$(".member a.add_save").live("click",d),$(".member a.edit").live("click",p),$(".member a.edit_save").live("click",f),$(".member a.edit_exit").live("click",u),$(".member a.del").live("click",h),$(".member a.edit_role").live("click",function(){var e=$(this).parent().parent().attr("role");
return""==e?(tips(LNG.group_already_remove,!1),void 0):(Group.edit(e),void 0)})};return{init:s,bindEvent:m}});